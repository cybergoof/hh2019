<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>Recover cleartext document &#8211; HolidayHack 2018 Solutions</title> <meta name="description" content="This is the solutions for the HH2018."> <meta name="keywords" content="sample post, readability, test"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/logo.png"> <meta name="twitter:title" content="Recover cleartext document"> <meta name="twitter:description" content=" QuestionHolly Evergreen hint says to listen to Ron Bowes talk on reverse engineering.NOTES FROM TALKTools - IDA. www.hex-rays.com/products/ida/support/download_freeware.htmlMicrosoft StudioRuby 2.4KEYS7 or 8 Bytes - DES, 16, 24, 32 Bytes - AESKeys will look randomKey is shared somehowKeys should be cryptographically random. If you see a weak random generator, then the numbers are not actually random.DemoIn the example, he shows that some keys are generated once a second. So, the key is based on time. In the hint for this question, we know when the program was executed. So we likely can use that to get the keyIf the seed is the current time, then we know the code.Detecting bad RamdonLinear Congruential GeneratorYou start with a SEED, and then some random number is generated from it.Take the SEED, and google the number. You likely will find the implementationHINT: 29943829. Copy the constant into google, you might get the function.We want to figure out what the algorithm is, and what the mode is.1-byte blocks - A stream cipher like RC4 or Salsa20.8 byte blocks - 7 or 8 byte key? DES16 byte blocks? 16 or 24 or 32 byte key? AES-128, AES-192 or AES-256ECB encrypts each blocks separatly so.CBC with no IV is also bad."> <meta name="twitter:site" content="@thecybergoof"> <meta name="twitter:creator" content="@thecybergoof"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Recover cleartext document"> <meta property="og:description" content=" QuestionHolly Evergreen hint says to listen to Ron Bowes talk on reverse engineering.NOTES FROM TALKTools - IDA. www.hex-rays.com/products/ida/support/download_freeware.htmlMicrosoft StudioRuby 2.4KEYS7 or 8 Bytes - DES, 16, 24, 32 Bytes - AESKeys will look randomKey is shared somehowKeys should be cryptographically random. If you see a weak random generator, then the numbers are not actually random.DemoIn the example, he shows that some keys are generated once a second. So, the key is based on time. In the hint for this question, we know when the program was executed. So we likely can use that to get the keyIf the seed is the current time, then we know the code.Detecting bad RamdonLinear Congruential GeneratorYou start with a SEED, and then some random number is generated from it.Take the SEED, and google the number. You likely will find the implementationHINT: 29943829. Copy the constant into google, you might get the function.We want to figure out what the algorithm is, and what the mode is.1-byte blocks - A stream cipher like RC4 or Salsa20.8 byte blocks - 7 or 8 byte key? DES16 byte blocks? 16 or 24 or 32 byte key? AES-128, AES-192 or AES-256ECB encrypts each blocks separatly so.CBC with no IV is also bad."> <meta property="og:url" content="http://localhost:4000/objectives/obj10/"> <meta property="og:site_name" content="HolidayHack 2018 Solutions"> <meta property="og:image" content="http://localhost:4000/assets/img/logo.png"> <link rel="canonical" href="http://localhost:4000/objectives/obj10/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="HolidayHack 2018 Solutions Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <link rel="stylesheet" href="http://localhost:4000/assets/css/hh2018.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/santa-claus-hat-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/santa-claus-hat-114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/santa-claus-hat-144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css"> body { background-image:url(http://localhost:4000/assets/img/home-kringlecon.jpg); { % unless site.tiled_bg % } background-repeat: no-repeat; background-size: cover; { % endunless % } } </style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/logo.png" alt="HolidayHack 2018 Solutions photo" class="author-photo"> <h4>HolidayHack 2018 Solutions</h4> <p>This is the solutions for the HH2018.</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/thecybergoof" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://linkedin.com/in/cybergoof" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/cybergoof" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> <li> <a href="http://stackoverflow.com/users/3734935/cybergoof" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-stack-overflow"></i> StackOverflow</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="http://localhost:4000/objectives/">Objectives</a> </li> <li> <a href="http://localhost:4000/elves/">Elf Terminals</a> </li> <li><a href="http://localhost:4000/projects/" >Projects</a></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Objective 10: Recover cleartext document</h1> <div class="PageNavigation"> <a class="prev" href="/objectives/obj09/">&laquo; Retrieve Scraps of Paper from Server</a> <a class="next" href="/objectives/sample/">Letter Challenge &raquo;</a> </div> </div> <h2>The Objective</h2> <img src="/assets/img/objectives/10/question.png"> <h2>The Solution</h2> <figure> <img src="/assets/img/objectives/10/question.jpg" /> <figcaption>Question</figcaption> </figure> <p>Holly Evergreen hint says to listen to Ron Bowes talk on reverse engineering.</p> <p>NOTES FROM TALK</p> <p>Tools - IDA. www.hex-rays.com/products/ida/support/download_freeware.html Microsoft Studio Ruby 2.4</p> <p>KEYS 7 or 8 Bytes - DES, 16, 24, 32 Bytes - AES Keys will look random Key is shared somehow Keys should be cryptographically random. If you see a weak random generator, then the numbers are not actually random.</p> <p>Demo In the example, he shows that some keys are generated once a second. So, the key is based on time. In the hint for this question, we know when the program was executed. So we likely can use that to get the key</p> <p>If the seed is the current time, then we know the code.</p> <p>Detecting bad Ramdon Linear Congruential Generator You start with a SEED, and then some random number is generated from it.</p> <p>Take the SEED, and google the number. You likely will find the implementation HINT: 29943829. Copy the constant into google, you might get the function.</p> <p>We want to figure out what the algorithm is, and what the mode is.</p> <p>1-byte blocks - A stream cipher like RC4 or Salsa20. 8 byte blocks - 7 or 8 byte key? DES 16 byte blocks? 16 or 24 or 32 byte key? AES-128, AES-192 or AES-256</p> <p>ECB encrypts each blocks separatly so. CBC with no IV is also bad.</p> <h2>ANSWER: </h2> <H2>The Narrative</H2> <figure> <img src="/assets/img/narratives/narrative..png"> <figcaption>Message in Narrative</figcaption> </figure> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#sample post" title="Pages tagged sample post" class="tag"><span class="term">sample post</span></a><a href="http://localhost:4000/tags/#readability" title="Pages tagged readability" class="tag"><span class="term">readability</span></a><a href="http://localhost:4000/tags/#test" title="Pages tagged test" class="tag"><span class="term">test</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/objectives/obj10/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/objectives/obj10/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/objectives/obj10/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
